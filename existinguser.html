<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Existing User - Sunrise Hospital</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
</head>

<body class="bg-gray-50 font-sans antialiased">

  <!-- Header -->
  <nav class="bg-white shadow-sm sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between h-16 items-center">
        <a href="index.html" class="text-xl font-bold text-indigo-600 flex items-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2 text-indigo-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" />
          </svg>
          Sunrise Hospital
        </a>
        <div class="hidden md:flex space-x-8">
          <a href="index.html" class="text-gray-700 hover:text-indigo-600 font-medium transition-colors">Home</a>
          <a href="book-appointment.html" class="text-gray-700 hover:text-indigo-600 font-medium transition-colors">Book Appointment</a>
          <a href="doctors.html" class="text-gray-700 hover:text-indigo-600 font-medium transition-colors">Doctors</a>
          <a href="admin-login.html" class="text-gray-700 hover:text-indigo-600 font-medium transition-colors">Admin</a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <header class="bg-gradient-to-r from-blue-600 to-teal-500 py-12 shadow-md">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center">
      <h1 class="text-3xl font-bold text-white flex items-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
        </svg>
        Welcome Back!
      </h1>
      <a href="index.html" class="text-white hover:text-yellow-200 transition-colors flex items-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
        </svg>
        Back to Home
      </a>
    </div>
  </header>

  <!-- Main Content -->
  <main class="py-12 animate__animated animate__fadeIn">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="bg-white rounded-xl shadow-xl overflow-hidden">
        <div class="p-8 text-center">
          <div class="inline-block bg-indigo-100 p-4 rounded-full mb-6">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
          <h3 class="text-2xl font-bold text-gray-800 mb-6">Your Digital Token</h3>
          
          <div id="qrcode" class="flex justify-center mb-8 mx-auto w-48 h-48 bg-white p-4 rounded-lg border-2 border-indigo-100 shadow-sm"></div>
          
          <div class="bg-indigo-50 inline-block px-6 py-3 rounded-full mb-6">
            <p class="text-lg font-semibold text-gray-800">Token Number: 
              <span id="tokenNumber" class="font-bold text-indigo-600 text-xl"></span>
            </p>
            <button id="downloadBtn" class="mt-4 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-6 rounded">
              Download QR Code
            </button>
          </div>
          
          <p class="text-gray-600 mt-6">Please show this QR code at the reception when your token is called.</p>
        </div>
      </div>
    </div>
    
  </main>

  <!-- Footer -->
  <footer class="bg-gradient-to-r from-blue-700 to-teal-600 py-8 text-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <p class="text-sm md:text-base">Â© 2025 Sunrise Hospital. All Rights Reserved.</p>
    </div>
  
    
  </footer>
  <script>
    // Dummy user details
    const name = "John Doe"; 
    const email = "john@example.com";
    const phone = "9876543210";
  
    // Retrieve the last token number from localStorage, or start at 0
    let lastToken = parseInt(localStorage.getItem('lastTokenNumber')) || 0;
  
    // Increment token
    let newTokenNumber = lastToken + 1;
  
    // Reset to 1 if it exceeds 100
    if (newTokenNumber > 100) {
      newTokenNumber = 1;
    }
  
    // Save new token back to localStorage
    localStorage.setItem('lastTokenNumber', newTokenNumber);
  
    // Display the token
    document.getElementById('tokenNumber').textContent = newTokenNumber;
  
    // Combine all details for QR code
    const qrData = `Name: ${name}\nEmail: ${email}\nPhone: ${phone}\nToken: ${newTokenNumber}`;
  
    // Generate QR Code
    const qrCode = new QRCode(document.getElementById('qrcode'), {
      text: qrData,
      width: 180,
      height: 180,
      colorDark: "#1E3A8A",
      colorLight: "#ffffff",
      correctLevel: QRCode.CorrectLevel.H
    });
  
    // Save patient list for admin (optional)
    const patients = JSON.parse(localStorage.getItem('patients')) || [];
    patients.push({ name, email, phone, token: newTokenNumber, timestamp: new Date().toISOString() });
    localStorage.setItem('patients', JSON.stringify(patients));
  
    // Download QR code logic
    document.getElementById('downloadBtn').addEventListener('click', function() {
      // Find the canvas inside the QR code div
      const qrCanvas = document.querySelector('#qrcode canvas');
      if (qrCanvas) {
        // Create a temporary link
        const link = document.createElement('a');
        link.href = qrCanvas.toDataURL("image/png");
        link.download = `token_${newTokenNumber}.png`;
        link.click();
      } else {
        alert("QR Code not ready yet. Please try again.");
      }
    });
  </script>
  
</body>
</html>